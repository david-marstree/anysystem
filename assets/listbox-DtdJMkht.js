import{$ as ye,a as Ie,w as $e,T as De,r as Pe}from"./use-resolve-button-type-DRx0-JiP.js";import{r as u,R as M}from"./index-DRjF_FHU.js";import{r as N}from"./index-CmHj60O0.js";import{l as Te,T as Ee,a as Le,z as Me,v as we,j as Fe,u as Ce,y as Ae,F as ke,I as _e,x as Ne,b as Be,R as Ue,c as Qe,f as Ve,d as He,K as Ke,e as S,p as je,g as re}from"./lodash-BHNxmqSH.js";import{s as de,n as H,o as b,M as le,W as K,y as j,e as V,p as pe,d as ze,i as W,H as z,D as fe,u as Ge,V as qe,g as We,A as Xe,b as Ye,a as I}from"./open-closed-12XbF_VX.js";import{a as Ze,F as Je,G as et,n as tt,b as nt,y as ot,t as rt,A as it,h as at,j as lt,c as se,_ as st}from"./portal-BoPUeaCu.js";import{m as ut}from"./transition-A3JfTXRq.js";function ct(e,o){let[i,t]=u.useState(e),r=de(e);return H(()=>t(r.current),[r,t,...o]),i}function dt(e,o){let i=u.useRef({left:0,top:0});if(H(()=>{let r=o.current;if(!r)return;let s=r.getBoundingClientRect();s&&(i.current=s)},[e]),o.current==null||!e||o.current===document.activeElement)return!1;let t=o.current.getBoundingClientRect();return t.top!==i.current.top||t.left!==i.current.left}let ue=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function ce(e){var o,i;let t=(o=e.innerText)!=null?o:"",r=e.cloneNode(!0);if(!(r instanceof HTMLElement))return t;let s=!1;for(let f of r.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))f.remove(),s=!0;let p=s?(i=r.innerText)!=null?i:"":t;return ue.test(p)&&(p=p.replace(ue,"")),p}function pt(e){let o=e.getAttribute("aria-label");if(typeof o=="string")return o.trim();let i=e.getAttribute("aria-labelledby");if(i){let t=i.split(" ").map(r=>{let s=document.getElementById(r);if(s){let p=s.getAttribute("aria-label");return typeof p=="string"?p.trim():ce(s).trim()}return null}).filter(Boolean);if(t.length>0)return t.join(", ")}return ce(e).trim()}function ft(e){let o=u.useRef(""),i=u.useRef("");return b(()=>{let t=e.current;if(!t)return"";let r=t.innerText;if(o.current===r)return i.current;let s=pt(t).trim().toLowerCase();return o.current=r,i.current=s,s})}var vt=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(vt||{}),bt=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(bt||{}),xt=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(xt||{}),mt=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.GoToOption=2]="GoToOption",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterOption=5]="RegisterOption",e[e.UnregisterOption=6]="UnregisterOption",e))(mt||{});function ie(e,o=i=>i){let i=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,t=st(o(e.options.slice()),s=>s.dataRef.current.domRef.current),r=i?t.indexOf(i):null;return r===-1&&(r=null),{options:t,activeOptionIndex:r}}let gt={1(e){return e.dataRef.current.disabled||e.listboxState===1?e:{...e,activeOptionIndex:null,listboxState:1,__demoMode:!1}},0(e){if(e.dataRef.current.disabled||e.listboxState===0)return e;let o=e.activeOptionIndex,{isSelected:i}=e.dataRef.current,t=e.options.findIndex(r=>i(r.dataRef.current.value));return t!==-1&&(o=t),{...e,listboxState:0,activeOptionIndex:o,__demoMode:!1}},2(e,o){var i,t,r,s,p;if(e.dataRef.current.disabled||e.listboxState===1)return e;let f={...e,searchQuery:"",activationTrigger:(i=o.trigger)!=null?i:1,__demoMode:!1};if(o.focus===S.Nothing)return{...f,activeOptionIndex:null};if(o.focus===S.Specific)return{...f,activeOptionIndex:e.options.findIndex(a=>a.id===o.id)};if(o.focus===S.Previous){let a=e.activeOptionIndex;if(a!==null){let n=e.options[a].dataRef.current.domRef,d=re(o,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:v=>v.id,resolveDisabled:v=>v.dataRef.current.disabled});if(d!==null){let v=e.options[d].dataRef.current.domRef;if(((t=n.current)==null?void 0:t.previousElementSibling)===v.current||((r=v.current)==null?void 0:r.previousElementSibling)===null)return{...f,activeOptionIndex:d}}}}else if(o.focus===S.Next){let a=e.activeOptionIndex;if(a!==null){let n=e.options[a].dataRef.current.domRef,d=re(o,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:v=>v.id,resolveDisabled:v=>v.dataRef.current.disabled});if(d!==null){let v=e.options[d].dataRef.current.domRef;if(((s=n.current)==null?void 0:s.nextElementSibling)===v.current||((p=v.current)==null?void 0:p.nextElementSibling)===null)return{...f,activeOptionIndex:d}}}}let c=ie(e),g=re(o,{resolveItems:()=>c.options,resolveActiveIndex:()=>c.activeOptionIndex,resolveId:a=>a.id,resolveDisabled:a=>a.dataRef.current.disabled});return{...f,...c,activeOptionIndex:g}},3:(e,o)=>{if(e.dataRef.current.disabled||e.listboxState===1)return e;let i=e.searchQuery!==""?0:1,t=e.searchQuery+o.value.toLowerCase(),r=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+i).concat(e.options.slice(0,e.activeOptionIndex+i)):e.options).find(p=>{var f;return!p.dataRef.current.disabled&&((f=p.dataRef.current.textValue)==null?void 0:f.startsWith(t))}),s=r?e.options.indexOf(r):-1;return s===-1||s===e.activeOptionIndex?{...e,searchQuery:t}:{...e,searchQuery:t,activeOptionIndex:s,activationTrigger:1}},4(e){return e.dataRef.current.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},5:(e,o)=>{let i={id:o.id,dataRef:o.dataRef},t=ie(e,r=>[...r,i]);return e.activeOptionIndex===null&&e.dataRef.current.isSelected(o.dataRef.current.value)&&(t.activeOptionIndex=t.options.indexOf(i)),{...e,...t}},6:(e,o)=>{let i=ie(e,t=>{let r=t.findIndex(s=>s.id===o.id);return r!==-1&&t.splice(r,1),t});return{...e,...i,activationTrigger:1}}},ae=u.createContext(null);ae.displayName="ListboxActionsContext";function X(e){let o=u.useContext(ae);if(o===null){let i=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,X),i}return o}let Y=u.createContext(null);Y.displayName="ListboxDataContext";function G(e){let o=u.useContext(Y);if(o===null){let i=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,G),i}return o}function Rt(e,o){return V(o.type,gt,e,o)}let Ot=u.Fragment;function St(e,o){var i;let t=Ze(),{value:r,defaultValue:s,form:p,name:f,onChange:c,by:g,invalid:a=!1,disabled:n=t||!1,horizontal:d=!1,multiple:v=!1,__demoMode:w=!1,...F}=e;const k=d?"horizontal":"vertical";let _=j(o),T=Te(s),[h=v?[]:void 0,P]=Ee(r,c,T),[E,$]=u.useReducer(Rt,{dataRef:u.createRef(),listboxState:w?0:1,options:[],searchQuery:"",activeOptionIndex:null,activationTrigger:1,optionsVisible:!1,__demoMode:w}),A=u.useRef({static:!1,hold:!1}),x=u.useRef(null),L=u.useRef(null),B=u.useRef(new Map),R=Le(g),U=u.useCallback(O=>V(m.mode,{1:()=>h.some(y=>R(y,O)),0:()=>R(h,O)}),[h]),m=u.useMemo(()=>({...E,value:h,disabled:n,invalid:a,mode:v?1:0,orientation:k,compare:R,isSelected:U,optionsPropsRef:A,buttonRef:x,optionsRef:L,listRef:B}),[h,n,a,v,E,B]);H(()=>{E.dataRef.current=m},[m]);let q=m.listboxState===0;Je(q,[m.buttonRef,m.optionsRef],(O,y)=>{var C;$({type:1}),it(y,at.Loose)||(O.preventDefault(),(C=m.buttonRef.current)==null||C.focus())});let Z=u.useMemo(()=>({open:m.listboxState===0,disabled:n,invalid:a,value:h}),[m,n,h,a]),J=b(O=>{let y=m.options.find(C=>C.id===O);y&&oe(y.dataRef.current.value)}),ee=b(()=>{if(m.activeOptionIndex!==null){let{dataRef:O,id:y}=m.options[m.activeOptionIndex];oe(O.current.value),$({type:2,focus:S.Specific,id:y})}}),te=b(()=>$({type:0})),l=b(()=>$({type:1})),D=pe(),Q=b((O,y,C)=>{D.dispose(),D.microTask(()=>O===S.Specific?$({type:2,focus:S.Specific,id:y,trigger:C}):$({type:2,focus:O,trigger:C}))}),ne=b((O,y)=>($({type:5,id:O,dataRef:y}),()=>$({type:6,id:O}))),oe=b(O=>V(m.mode,{0(){return P==null?void 0:P(O)},1(){let y=m.value.slice(),C=y.findIndex(he=>R(he,O));return C===-1?y.push(O):y.splice(C,1),P==null?void 0:P(y)}})),be=b(O=>$({type:3,value:O})),xe=b(()=>$({type:4})),me=u.useMemo(()=>({onChange:oe,registerOption:ne,goToOption:Q,closeListbox:l,openListbox:te,selectActiveOption:ee,selectOption:J,search:be,clearSearch:xe}),[]),[ge,Re]=Me({inherit:!0}),Oe={ref:_},Se=u.useCallback(()=>{if(T!==void 0)return P==null?void 0:P(T)},[P,T]);return M.createElement(Re,{value:ge,props:{htmlFor:(i=m.buttonRef.current)==null?void 0:i.id},slot:{open:m.listboxState===0,disabled:n}},M.createElement(we,null,M.createElement(ae.Provider,{value:me},M.createElement(Y.Provider,{value:m},M.createElement(ze,{value:V(m.listboxState,{0:W.Open,1:W.Closed})},f!=null&&h!=null&&M.createElement(Fe,{disabled:n,data:{[f]:h},form:p,onReset:Se}),z({ourProps:Oe,theirProps:F,slot:Z,defaultTag:Ot,name:"Listbox"}))))))}let ht="button";function yt(e,o){var i;let t=G("Listbox.Button"),r=X("Listbox.Button"),s=u.useId(),p=Ce(),{id:f=p||`headlessui-listbox-button-${s}`,disabled:c=t.disabled||!1,autoFocus:g=!1,...a}=e,n=j(t.buttonRef,o,Ae()),d=ke(),v=b(R=>{switch(R.key){case I.Enter:je(R.currentTarget);break;case I.Space:case I.ArrowDown:R.preventDefault(),N.flushSync(()=>r.openListbox()),t.value||r.goToOption(S.First);break;case I.ArrowUp:R.preventDefault(),N.flushSync(()=>r.openListbox()),t.value||r.goToOption(S.Last);break}}),w=b(R=>{switch(R.key){case I.Space:R.preventDefault();break}}),F=b(R=>{var U;if(Pe(R.currentTarget))return R.preventDefault();t.listboxState===0?(N.flushSync(()=>r.closeListbox()),(U=t.buttonRef.current)==null||U.focus({preventScroll:!0})):(R.preventDefault(),r.openListbox())}),k=b(R=>R.preventDefault()),_=_e([f]),T=et(),{isFocusVisible:h,focusProps:P}=ye({autoFocus:g}),{isHovered:E,hoverProps:$}=Ie({isDisabled:c}),{pressed:A,pressProps:x}=$e({disabled:c}),L=u.useMemo(()=>({open:t.listboxState===0,active:A||t.listboxState===0,disabled:c,invalid:t.invalid,value:t.value,hover:E,focus:h,autofocus:g}),[t.listboxState,t.value,c,E,h,A,t.invalid,g]),B=fe(d(),{ref:n,id:f,type:De(e,t.buttonRef),"aria-haspopup":"listbox","aria-controls":(i=t.optionsRef.current)==null?void 0:i.id,"aria-expanded":t.listboxState===0,"aria-labelledby":_,"aria-describedby":T,disabled:c||void 0,autoFocus:g,onKeyDown:v,onKeyUp:w,onKeyPress:k,onClick:F},P,$,x);return z({ourProps:B,theirProps:a,slot:L,defaultTag:ht,name:"Listbox.Button"})}let ve=u.createContext(!1),It="div",$t=le.RenderStrategy|le.Static;function Dt(e,o){var i;let t=u.useId(),{id:r=`headlessui-listbox-options-${t}`,anchor:s,portal:p=!1,modal:f=!0,transition:c=!1,...g}=e,a=Ne(s);a&&(p=!0);let n=G("Listbox.Options"),d=X("Listbox.Options"),v=tt(n.optionsRef),w=Ge(),[F,k]=qe(c,n.optionsRef,w!==null?(w&W.Open)===W.Open:n.listboxState===0);ut(F,n.buttonRef,d.closeListbox);let _=n.__demoMode?!1:f&&n.listboxState===0;nt(_,v);let T=n.__demoMode?!1:f&&n.listboxState===0;ot(T,{allowed:b(()=>[n.buttonRef.current,n.optionsRef.current])});let h=n.listboxState!==0,P=dt(h,n.buttonRef)?!1:F,E=F&&n.listboxState===1,$=Be(E,n.value),A=b(l=>n.compare($,l)),x=u.useMemo(()=>{var l;if(a==null||!((l=a==null?void 0:a.to)!=null&&l.includes("selection")))return null;let D=n.options.findIndex(Q=>A(Q.dataRef.current.value));return D===-1&&(D=0),D},[a,n.options]),L=(()=>{if(a==null)return;if(x===null)return{...a,inner:void 0};let l=Array.from(n.listRef.current.values());return{...a,inner:{listRef:{current:l},index:x}}})(),[B,R]=Ue(L),U=Qe(),m=j(n.optionsRef,o,a?B:null),q=pe();u.useEffect(()=>{var l;let D=n.optionsRef.current;D&&n.listboxState===0&&D!==((l=We(D))==null?void 0:l.activeElement)&&(D==null||D.focus({preventScroll:!0}))},[n.listboxState,n.optionsRef,n.optionsRef.current]);let Z=b(l=>{var D,Q;switch(q.dispose(),l.key){case I.Space:if(n.searchQuery!=="")return l.preventDefault(),l.stopPropagation(),d.search(l.key);case I.Enter:if(l.preventDefault(),l.stopPropagation(),n.activeOptionIndex!==null){let{dataRef:ne}=n.options[n.activeOptionIndex];d.onChange(ne.current.value)}n.mode===0&&(N.flushSync(()=>d.closeListbox()),(D=n.buttonRef.current)==null||D.focus({preventScroll:!0}));break;case V(n.orientation,{vertical:I.ArrowDown,horizontal:I.ArrowRight}):return l.preventDefault(),l.stopPropagation(),d.goToOption(S.Next);case V(n.orientation,{vertical:I.ArrowUp,horizontal:I.ArrowLeft}):return l.preventDefault(),l.stopPropagation(),d.goToOption(S.Previous);case I.Home:case I.PageUp:return l.preventDefault(),l.stopPropagation(),d.goToOption(S.First);case I.End:case I.PageDown:return l.preventDefault(),l.stopPropagation(),d.goToOption(S.Last);case I.Escape:l.preventDefault(),l.stopPropagation(),N.flushSync(()=>d.closeListbox()),(Q=n.buttonRef.current)==null||Q.focus({preventScroll:!0});return;case I.Tab:l.preventDefault(),l.stopPropagation(),N.flushSync(()=>d.closeListbox()),lt(n.buttonRef.current,l.shiftKey?se.Previous:se.Next);break;default:l.key.length===1&&(d.search(l.key),q.setTimeout(()=>d.clearSearch(),350));break}}),J=ct(()=>{var l;return(l=n.buttonRef.current)==null?void 0:l.id},[n.buttonRef.current]),ee=u.useMemo(()=>({open:n.listboxState===0}),[n.listboxState]),te=fe(a?U():{},{id:r,ref:m,"aria-activedescendant":n.activeOptionIndex===null||(i=n.options[n.activeOptionIndex])==null?void 0:i.id,"aria-multiselectable":n.mode===1?!0:void 0,"aria-labelledby":J,"aria-orientation":n.orientation,onKeyDown:Z,role:"listbox",tabIndex:n.listboxState===0?0:void 0,style:{...g.style,...R,"--button-width":Ve(n.buttonRef,!0).width},...Xe(k)});return M.createElement(rt,{enabled:p?e.static||F:!1},M.createElement(Y.Provider,{value:n.mode===1?n:{...n,isSelected:A}},z({ourProps:te,theirProps:g,slot:ee,defaultTag:It,features:$t,visible:P,name:"Listbox.Options"})))}let Pt="div";function Tt(e,o){let i=u.useId(),{id:t=`headlessui-listbox-option-${i}`,disabled:r=!1,value:s,...p}=e,f=u.useContext(ve)===!0,c=G("Listbox.Option"),g=X("Listbox.Option"),a=c.activeOptionIndex!==null?c.options[c.activeOptionIndex].id===t:!1,n=c.isSelected(s),d=u.useRef(null),v=ft(d),w=de({disabled:r,value:s,domRef:d,get textValue(){return v()}}),F=j(o,d,x=>{x?c.listRef.current.set(t,x):c.listRef.current.delete(t)});H(()=>{if(!c.__demoMode&&c.listboxState===0&&a&&c.activationTrigger!==0)return Ye().requestAnimationFrame(()=>{var x,L;(L=(x=d.current)==null?void 0:x.scrollIntoView)==null||L.call(x,{block:"nearest"})})},[d,a,c.__demoMode,c.listboxState,c.activationTrigger,c.activeOptionIndex]),H(()=>{if(!f)return g.registerOption(t,w)},[w,t,f]);let k=b(x=>{var L;if(r)return x.preventDefault();g.onChange(s),c.mode===0&&(N.flushSync(()=>g.closeListbox()),(L=c.buttonRef.current)==null||L.focus({preventScroll:!0}))}),_=b(()=>{if(r)return g.goToOption(S.Nothing);g.goToOption(S.Specific,t)}),T=He(),h=b(x=>{T.update(x),!r&&(a||g.goToOption(S.Specific,t,0))}),P=b(x=>{T.wasMoved(x)&&(r||a||g.goToOption(S.Specific,t,0))}),E=b(x=>{T.wasMoved(x)&&(r||a&&g.goToOption(S.Nothing))}),$=u.useMemo(()=>({active:a,focus:a,selected:n,disabled:r,selectedOption:n&&f}),[a,n,r,f]);return!n&&f?null:z({ourProps:f?{}:{id:t,ref:F,role:"option",tabIndex:r===!0?void 0:-1,"aria-disabled":r===!0?!0:void 0,"aria-selected":n,disabled:void 0,onClick:k,onFocus:_,onPointerEnter:h,onMouseEnter:h,onPointerMove:P,onMouseMove:P,onPointerLeave:E,onMouseLeave:E},theirProps:p,slot:$,defaultTag:Pt,name:"Listbox.Option"})}let Et=u.Fragment;function Lt(e,o){let{options:i,placeholder:t,...r}=e,s={ref:j(o)},p=G("ListboxSelectedOption"),f=u.useMemo(()=>({}),[]),c=p.value===void 0||p.value===null||p.mode===1&&Array.isArray(p.value)&&p.value.length===0;return M.createElement(ve.Provider,{value:!0},z({ourProps:s,theirProps:{...r,children:M.createElement(M.Fragment,null,t&&c?t:i)},slot:f,defaultTag:Et,name:"ListboxSelectedOption"}))}let Mt=K(St),wt=K(yt),Ft=Ke,Ct=K(Dt),At=K(Tt),kt=K(Lt),Kt=Object.assign(Mt,{Button:wt,Label:Ft,Options:Ct,Option:At,SelectedOption:kt});export{Ct as G,Kt as M,wt as U,At as V};
