import{$ as ye,a as Ie,r as $e}from"./bugs-DbHXcW6g.js";import{r as u,R as M}from"./iframe-gIK4bdEr.js";import{r as N}from"./index-BPuoX7PR.js";import{w as De,T as Pe}from"./use-resolve-button-type-CGEIKNbq.js";import{u as Te}from"./use-by-comparator-CZU-NL2p.js";import{s as de,n as H,a as b,M as le,W as j,y as K,b as V,p as pe,H as z,D as fe,u as Ee,c as Le,o as I}from"./keyboard-ea4pcW4v.js";import{l as Me,T as Fe,z as we,j as Ce,u as Ae,I as ke,K as _e,p as Ne}from"./label-CKvBRiA1.js";import{v as Be,y as Ue,F as Qe,x as Ve,l as He,R as je,f as Ke,g as ze,h as Ge,i as S,j as re}from"./lodash-CKelhqjC.js";import{F as qe,n as We,f as Xe,y as Ye,t as Ze}from"./portal-DJ8oPe_c.js";import{m as Je}from"./transition-BSBR0-FO.js";import{c as et,i as W,u as tt,V as ot,A as nt}from"./open-closed-D6AVR6gh.js";import{a as rt,G as it}from"./description-Bx7Nq89P.js";import{A as at,h as lt,j as st,F as se,_ as ut}from"./focus-management-Ddlno2iB.js";function ct(e,n){let[i,t]=u.useState(e),r=de(e);return H(()=>t(r.current),[r,t,...n]),i}function dt(e,n){let i=u.useRef({left:0,top:0});if(H(()=>{let r=n.current;if(!r)return;let s=r.getBoundingClientRect();s&&(i.current=s)},[e]),n.current==null||!e||n.current===document.activeElement)return!1;let t=n.current.getBoundingClientRect();return t.top!==i.current.top||t.left!==i.current.left}let ue=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function ce(e){var n,i;let t=(n=e.innerText)!=null?n:"",r=e.cloneNode(!0);if(!(r instanceof HTMLElement))return t;let s=!1;for(let f of r.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))f.remove(),s=!0;let p=s?(i=r.innerText)!=null?i:"":t;return ue.test(p)&&(p=p.replace(ue,"")),p}function pt(e){let n=e.getAttribute("aria-label");if(typeof n=="string")return n.trim();let i=e.getAttribute("aria-labelledby");if(i){let t=i.split(" ").map(r=>{let s=document.getElementById(r);if(s){let p=s.getAttribute("aria-label");return typeof p=="string"?p.trim():ce(s).trim()}return null}).filter(Boolean);if(t.length>0)return t.join(", ")}return ce(e).trim()}function ft(e){let n=u.useRef(""),i=u.useRef("");return b(()=>{let t=e.current;if(!t)return"";let r=t.innerText;if(n.current===r)return i.current;let s=pt(t).trim().toLowerCase();return n.current=r,i.current=s,s})}var vt=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(vt||{}),bt=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(bt||{}),xt=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(xt||{}),mt=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.GoToOption=2]="GoToOption",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterOption=5]="RegisterOption",e[e.UnregisterOption=6]="UnregisterOption",e))(mt||{});function ie(e,n=i=>i){let i=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,t=ut(n(e.options.slice()),s=>s.dataRef.current.domRef.current),r=i?t.indexOf(i):null;return r===-1&&(r=null),{options:t,activeOptionIndex:r}}let gt={1(e){return e.dataRef.current.disabled||e.listboxState===1?e:{...e,activeOptionIndex:null,listboxState:1,__demoMode:!1}},0(e){if(e.dataRef.current.disabled||e.listboxState===0)return e;let n=e.activeOptionIndex,{isSelected:i}=e.dataRef.current,t=e.options.findIndex(r=>i(r.dataRef.current.value));return t!==-1&&(n=t),{...e,listboxState:0,activeOptionIndex:n,__demoMode:!1}},2(e,n){var i,t,r,s,p;if(e.dataRef.current.disabled||e.listboxState===1)return e;let f={...e,searchQuery:"",activationTrigger:(i=n.trigger)!=null?i:1,__demoMode:!1};if(n.focus===S.Nothing)return{...f,activeOptionIndex:null};if(n.focus===S.Specific)return{...f,activeOptionIndex:e.options.findIndex(a=>a.id===n.id)};if(n.focus===S.Previous){let a=e.activeOptionIndex;if(a!==null){let o=e.options[a].dataRef.current.domRef,d=re(n,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:v=>v.id,resolveDisabled:v=>v.dataRef.current.disabled});if(d!==null){let v=e.options[d].dataRef.current.domRef;if(((t=o.current)==null?void 0:t.previousElementSibling)===v.current||((r=v.current)==null?void 0:r.previousElementSibling)===null)return{...f,activeOptionIndex:d}}}}else if(n.focus===S.Next){let a=e.activeOptionIndex;if(a!==null){let o=e.options[a].dataRef.current.domRef,d=re(n,{resolveItems:()=>e.options,resolveActiveIndex:()=>e.activeOptionIndex,resolveId:v=>v.id,resolveDisabled:v=>v.dataRef.current.disabled});if(d!==null){let v=e.options[d].dataRef.current.domRef;if(((s=o.current)==null?void 0:s.nextElementSibling)===v.current||((p=v.current)==null?void 0:p.nextElementSibling)===null)return{...f,activeOptionIndex:d}}}}let c=ie(e),g=re(n,{resolveItems:()=>c.options,resolveActiveIndex:()=>c.activeOptionIndex,resolveId:a=>a.id,resolveDisabled:a=>a.dataRef.current.disabled});return{...f,...c,activeOptionIndex:g}},3:(e,n)=>{if(e.dataRef.current.disabled||e.listboxState===1)return e;let i=e.searchQuery!==""?0:1,t=e.searchQuery+n.value.toLowerCase(),r=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+i).concat(e.options.slice(0,e.activeOptionIndex+i)):e.options).find(p=>{var f;return!p.dataRef.current.disabled&&((f=p.dataRef.current.textValue)==null?void 0:f.startsWith(t))}),s=r?e.options.indexOf(r):-1;return s===-1||s===e.activeOptionIndex?{...e,searchQuery:t}:{...e,searchQuery:t,activeOptionIndex:s,activationTrigger:1}},4(e){return e.dataRef.current.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},5:(e,n)=>{let i={id:n.id,dataRef:n.dataRef},t=ie(e,r=>[...r,i]);return e.activeOptionIndex===null&&e.dataRef.current.isSelected(n.dataRef.current.value)&&(t.activeOptionIndex=t.options.indexOf(i)),{...e,...t}},6:(e,n)=>{let i=ie(e,t=>{let r=t.findIndex(s=>s.id===n.id);return r!==-1&&t.splice(r,1),t});return{...e,...i,activationTrigger:1}}},ae=u.createContext(null);ae.displayName="ListboxActionsContext";function X(e){let n=u.useContext(ae);if(n===null){let i=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,X),i}return n}let Y=u.createContext(null);Y.displayName="ListboxDataContext";function G(e){let n=u.useContext(Y);if(n===null){let i=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,G),i}return n}function Rt(e,n){return V(n.type,gt,e,n)}let Ot=u.Fragment;function St(e,n){var i;let t=rt(),{value:r,defaultValue:s,form:p,name:f,onChange:c,by:g,invalid:a=!1,disabled:o=t||!1,horizontal:d=!1,multiple:v=!1,__demoMode:F=!1,...w}=e;const k=d?"horizontal":"vertical";let _=K(n),T=Me(s),[h=v?[]:void 0,P]=Fe(r,c,T),[E,$]=u.useReducer(Rt,{dataRef:u.createRef(),listboxState:F?0:1,options:[],searchQuery:"",activeOptionIndex:null,activationTrigger:1,optionsVisible:!1,__demoMode:F}),A=u.useRef({static:!1,hold:!1}),x=u.useRef(null),L=u.useRef(null),B=u.useRef(new Map),R=Te(g),U=u.useCallback(O=>V(m.mode,{1:()=>h.some(y=>R(y,O)),0:()=>R(h,O)}),[h]),m=u.useMemo(()=>({...E,value:h,disabled:o,invalid:a,mode:v?1:0,orientation:k,compare:R,isSelected:U,optionsPropsRef:A,buttonRef:x,optionsRef:L,listRef:B}),[h,o,a,v,E,B]);H(()=>{E.dataRef.current=m},[m]);let q=m.listboxState===0;qe(q,[m.buttonRef,m.optionsRef],(O,y)=>{var C;$({type:1}),at(y,lt.Loose)||(O.preventDefault(),(C=m.buttonRef.current)==null||C.focus())});let Z=u.useMemo(()=>({open:m.listboxState===0,disabled:o,invalid:a,value:h}),[m,o,h,a]),J=b(O=>{let y=m.options.find(C=>C.id===O);y&&ne(y.dataRef.current.value)}),ee=b(()=>{if(m.activeOptionIndex!==null){let{dataRef:O,id:y}=m.options[m.activeOptionIndex];ne(O.current.value),$({type:2,focus:S.Specific,id:y})}}),te=b(()=>$({type:0})),l=b(()=>$({type:1})),D=pe(),Q=b((O,y,C)=>{D.dispose(),D.microTask(()=>O===S.Specific?$({type:2,focus:S.Specific,id:y,trigger:C}):$({type:2,focus:O,trigger:C}))}),oe=b((O,y)=>($({type:5,id:O,dataRef:y}),()=>$({type:6,id:O}))),ne=b(O=>V(m.mode,{0(){return P==null?void 0:P(O)},1(){let y=m.value.slice(),C=y.findIndex(he=>R(he,O));return C===-1?y.push(O):y.splice(C,1),P==null?void 0:P(y)}})),be=b(O=>$({type:3,value:O})),xe=b(()=>$({type:4})),me=u.useMemo(()=>({onChange:ne,registerOption:oe,goToOption:Q,closeListbox:l,openListbox:te,selectActiveOption:ee,selectOption:J,search:be,clearSearch:xe}),[]),[ge,Re]=we({inherit:!0}),Oe={ref:_},Se=u.useCallback(()=>{if(T!==void 0)return P==null?void 0:P(T)},[P,T]);return M.createElement(Re,{value:ge,props:{htmlFor:(i=m.buttonRef.current)==null?void 0:i.id},slot:{open:m.listboxState===0,disabled:o}},M.createElement(Be,null,M.createElement(ae.Provider,{value:me},M.createElement(Y.Provider,{value:m},M.createElement(et,{value:V(m.listboxState,{0:W.Open,1:W.Closed})},f!=null&&h!=null&&M.createElement(Ce,{disabled:o,data:{[f]:h},form:p,onReset:Se}),z({ourProps:Oe,theirProps:w,slot:Z,defaultTag:Ot,name:"Listbox"}))))))}let ht="button";function yt(e,n){var i;let t=G("Listbox.Button"),r=X("Listbox.Button"),s=u.useId(),p=Ae(),{id:f=p||`headlessui-listbox-button-${s}`,disabled:c=t.disabled||!1,autoFocus:g=!1,...a}=e,o=K(t.buttonRef,n,Ue()),d=Qe(),v=b(R=>{switch(R.key){case I.Enter:Ne(R.currentTarget);break;case I.Space:case I.ArrowDown:R.preventDefault(),N.flushSync(()=>r.openListbox()),t.value||r.goToOption(S.First);break;case I.ArrowUp:R.preventDefault(),N.flushSync(()=>r.openListbox()),t.value||r.goToOption(S.Last);break}}),F=b(R=>{switch(R.key){case I.Space:R.preventDefault();break}}),w=b(R=>{var U;if($e(R.currentTarget))return R.preventDefault();t.listboxState===0?(N.flushSync(()=>r.closeListbox()),(U=t.buttonRef.current)==null||U.focus({preventScroll:!0})):(R.preventDefault(),r.openListbox())}),k=b(R=>R.preventDefault()),_=ke([f]),T=it(),{isFocusVisible:h,focusProps:P}=ye({autoFocus:g}),{isHovered:E,hoverProps:$}=Ie({isDisabled:c}),{pressed:A,pressProps:x}=De({disabled:c}),L=u.useMemo(()=>({open:t.listboxState===0,active:A||t.listboxState===0,disabled:c,invalid:t.invalid,value:t.value,hover:E,focus:h,autofocus:g}),[t.listboxState,t.value,c,E,h,A,t.invalid,g]),B=fe(d(),{ref:o,id:f,type:Pe(e,t.buttonRef),"aria-haspopup":"listbox","aria-controls":(i=t.optionsRef.current)==null?void 0:i.id,"aria-expanded":t.listboxState===0,"aria-labelledby":_,"aria-describedby":T,disabled:c||void 0,autoFocus:g,onKeyDown:v,onKeyUp:F,onKeyPress:k,onClick:w},P,$,x);return z({ourProps:B,theirProps:a,slot:L,defaultTag:ht,name:"Listbox.Button"})}let ve=u.createContext(!1),It="div",$t=le.RenderStrategy|le.Static;function Dt(e,n){var i;let t=u.useId(),{id:r=`headlessui-listbox-options-${t}`,anchor:s,portal:p=!1,modal:f=!0,transition:c=!1,...g}=e,a=Ve(s);a&&(p=!0);let o=G("Listbox.Options"),d=X("Listbox.Options"),v=We(o.optionsRef),F=tt(),[w,k]=ot(c,o.optionsRef,F!==null?(F&W.Open)===W.Open:o.listboxState===0);Je(w,o.buttonRef,d.closeListbox);let _=o.__demoMode?!1:f&&o.listboxState===0;Xe(_,v);let T=o.__demoMode?!1:f&&o.listboxState===0;Ye(T,{allowed:b(()=>[o.buttonRef.current,o.optionsRef.current])});let h=o.listboxState!==0,P=dt(h,o.buttonRef)?!1:w,E=w&&o.listboxState===1,$=He(E,o.value),A=b(l=>o.compare($,l)),x=u.useMemo(()=>{var l;if(a==null||!((l=a==null?void 0:a.to)!=null&&l.includes("selection")))return null;let D=o.options.findIndex(Q=>A(Q.dataRef.current.value));return D===-1&&(D=0),D},[a,o.options]),L=(()=>{if(a==null)return;if(x===null)return{...a,inner:void 0};let l=Array.from(o.listRef.current.values());return{...a,inner:{listRef:{current:l},index:x}}})(),[B,R]=je(L),U=Ke(),m=K(o.optionsRef,n,a?B:null),q=pe();u.useEffect(()=>{var l;let D=o.optionsRef.current;D&&o.listboxState===0&&D!==((l=Ee(D))==null?void 0:l.activeElement)&&(D==null||D.focus({preventScroll:!0}))},[o.listboxState,o.optionsRef,o.optionsRef.current]);let Z=b(l=>{var D,Q;switch(q.dispose(),l.key){case I.Space:if(o.searchQuery!=="")return l.preventDefault(),l.stopPropagation(),d.search(l.key);case I.Enter:if(l.preventDefault(),l.stopPropagation(),o.activeOptionIndex!==null){let{dataRef:oe}=o.options[o.activeOptionIndex];d.onChange(oe.current.value)}o.mode===0&&(N.flushSync(()=>d.closeListbox()),(D=o.buttonRef.current)==null||D.focus({preventScroll:!0}));break;case V(o.orientation,{vertical:I.ArrowDown,horizontal:I.ArrowRight}):return l.preventDefault(),l.stopPropagation(),d.goToOption(S.Next);case V(o.orientation,{vertical:I.ArrowUp,horizontal:I.ArrowLeft}):return l.preventDefault(),l.stopPropagation(),d.goToOption(S.Previous);case I.Home:case I.PageUp:return l.preventDefault(),l.stopPropagation(),d.goToOption(S.First);case I.End:case I.PageDown:return l.preventDefault(),l.stopPropagation(),d.goToOption(S.Last);case I.Escape:l.preventDefault(),l.stopPropagation(),N.flushSync(()=>d.closeListbox()),(Q=o.buttonRef.current)==null||Q.focus({preventScroll:!0});return;case I.Tab:l.preventDefault(),l.stopPropagation(),N.flushSync(()=>d.closeListbox()),st(o.buttonRef.current,l.shiftKey?se.Previous:se.Next);break;default:l.key.length===1&&(d.search(l.key),q.setTimeout(()=>d.clearSearch(),350));break}}),J=ct(()=>{var l;return(l=o.buttonRef.current)==null?void 0:l.id},[o.buttonRef.current]),ee=u.useMemo(()=>({open:o.listboxState===0}),[o.listboxState]),te=fe(a?U():{},{id:r,ref:m,"aria-activedescendant":o.activeOptionIndex===null||(i=o.options[o.activeOptionIndex])==null?void 0:i.id,"aria-multiselectable":o.mode===1?!0:void 0,"aria-labelledby":J,"aria-orientation":o.orientation,onKeyDown:Z,role:"listbox",tabIndex:o.listboxState===0?0:void 0,style:{...g.style,...R,"--button-width":ze(o.buttonRef,!0).width},...nt(k)});return M.createElement(Ze,{enabled:p?e.static||w:!1},M.createElement(Y.Provider,{value:o.mode===1?o:{...o,isSelected:A}},z({ourProps:te,theirProps:g,slot:ee,defaultTag:It,features:$t,visible:P,name:"Listbox.Options"})))}let Pt="div";function Tt(e,n){let i=u.useId(),{id:t=`headlessui-listbox-option-${i}`,disabled:r=!1,value:s,...p}=e,f=u.useContext(ve)===!0,c=G("Listbox.Option"),g=X("Listbox.Option"),a=c.activeOptionIndex!==null?c.options[c.activeOptionIndex].id===t:!1,o=c.isSelected(s),d=u.useRef(null),v=ft(d),F=de({disabled:r,value:s,domRef:d,get textValue(){return v()}}),w=K(n,d,x=>{x?c.listRef.current.set(t,x):c.listRef.current.delete(t)});H(()=>{if(!c.__demoMode&&c.listboxState===0&&a&&c.activationTrigger!==0)return Le().requestAnimationFrame(()=>{var x,L;(L=(x=d.current)==null?void 0:x.scrollIntoView)==null||L.call(x,{block:"nearest"})})},[d,a,c.__demoMode,c.listboxState,c.activationTrigger,c.activeOptionIndex]),H(()=>{if(!f)return g.registerOption(t,F)},[F,t,f]);let k=b(x=>{var L;if(r)return x.preventDefault();g.onChange(s),c.mode===0&&(N.flushSync(()=>g.closeListbox()),(L=c.buttonRef.current)==null||L.focus({preventScroll:!0}))}),_=b(()=>{if(r)return g.goToOption(S.Nothing);g.goToOption(S.Specific,t)}),T=Ge(),h=b(x=>{T.update(x),!r&&(a||g.goToOption(S.Specific,t,0))}),P=b(x=>{T.wasMoved(x)&&(r||a||g.goToOption(S.Specific,t,0))}),E=b(x=>{T.wasMoved(x)&&(r||a&&g.goToOption(S.Nothing))}),$=u.useMemo(()=>({active:a,focus:a,selected:o,disabled:r,selectedOption:o&&f}),[a,o,r,f]);return!o&&f?null:z({ourProps:f?{}:{id:t,ref:w,role:"option",tabIndex:r===!0?void 0:-1,"aria-disabled":r===!0?!0:void 0,"aria-selected":o,disabled:void 0,onClick:k,onFocus:_,onPointerEnter:h,onMouseEnter:h,onPointerMove:P,onMouseMove:P,onPointerLeave:E,onMouseLeave:E},theirProps:p,slot:$,defaultTag:Pt,name:"Listbox.Option"})}let Et=u.Fragment;function Lt(e,n){let{options:i,placeholder:t,...r}=e,s={ref:K(n)},p=G("ListboxSelectedOption"),f=u.useMemo(()=>({}),[]),c=p.value===void 0||p.value===null||p.mode===1&&Array.isArray(p.value)&&p.value.length===0;return M.createElement(ve.Provider,{value:!0},z({ourProps:s,theirProps:{...r,children:M.createElement(M.Fragment,null,t&&c?t:i)},slot:f,defaultTag:Et,name:"ListboxSelectedOption"}))}let Mt=j(St),Ft=j(yt),wt=_e,Ct=j(Dt),At=j(Tt),kt=j(Lt),Xt=Object.assign(Mt,{Button:Ft,Label:wt,Options:Ct,Option:At,SelectedOption:kt});export{Ct as G,Xt as M,Ft as U,At as V};
